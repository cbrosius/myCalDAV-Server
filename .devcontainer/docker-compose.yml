version: '3.8'

services:
  rust-dev:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ..:/workspace:cached
      - cargo-registry:/usr/local/cargo/registry
      - cargo-git:/usr/local/cargo/git
      - target-dir:/workspace/target
    command: sleep infinity
    ports:
      - "8080:8080"
      - "3000:3000"
    environment:
      - RUST_LOG=debug
      - DATABASE_URL=sqlite:./data/calendar.db
      - CARGO_TARGET_DIR=/workspace/target

volumes:
  cargo-registry:
  cargo-git:
  target-dir:
